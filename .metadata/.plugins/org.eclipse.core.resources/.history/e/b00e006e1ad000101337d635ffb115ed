package com.kh.spring.board.model.dao;

import java.util.ArrayList;

import org.apache.ibatis.session.RowBounds;
import org.mybatis.spring.SqlSessionTemplate;
import org.springframework.stereotype.Repository;

import com.kh.spring.board.model.vo.Board;
import com.kh.spring.common.model.vo.PageInfo;

@Repository
public class BoardDao {
	
	public ArrayList<Board> boardListView(SqlSessionTemplate sqlSession, PageInfo pi) {
		
		// 마이타비스에서 제공하는 rowbounds 객체를 이용해보자.
		// RowBounds 객체에 매개변수 offset과 limit를 전달한다.
		// offset : 몇개씩 건너뛰고 보여줄것인지에 대한 값
		// limit : 몇개씩 보여줄것인지에 대한 값 - boardLimit과 같은 값
		
		//한 페이지에 5개씩 게시글을 보여주기
		//1페이지 : 1 ~ 5 / 건너뛸값 없으니 0
		//2페이지 : 6 ~ 10 / 6번부터 보여줘야하니 건너뛸 값 5
		//3페이지 : 11 ~ 15 / 11번부터 보여줘야하니 건너뛸 값 10 
		
		int limit = pi.getBoardLimit(); // 한 페이지당 몇개씩 보여줄지에 관한 변수
		int offset = (pi.getCurrentPage()-1)*limit; 
		//현재 페이지가 2페이지면 건너뛸값 5. 
		
		RowBounds rowBounds = new RowBounds(offset,limit);
		
		//selectList의 두번째 매개변수는 파라미터 위치이기 때문에 rowBounds는 세번째 위치에 넣어야한다.
		//파라미터가 없다고해도 null을 채워서 자리를 맞춰 전달해야한다. 
		return (ArrayList) sqlSession.selectList("boardMapper.boardListView",null,rowBounds);
		
	}

	public int boardListCount(SqlSessionTemplate sqlSession) {
		
		return sqlSession.selectOne("boardMapper.boardListCount"); 
	}

}
